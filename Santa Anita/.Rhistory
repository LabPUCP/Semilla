library(openxlsx)
fileName='CENSO 2007 tipo poblacion.xlsx'
rural=read.xlsx(fileName)
names(rural) = c("Ubigeo", "Distrito", "por", "aumulado")
rural=rural[-c(9101:9106),]
View(rural)
distritos=rural[grep("Dist", rural$Distrito),1:2] #solo quiero quedarme con la 1 y 2 columna
head(distritos)
View(distritos)
distritos$Ubigeo= substr(distritos$Ubigeo,8,14)
View(distritos)
urbano=as.data.frame(rural[grep("Urbano", rural$Ubigeo),3])
View(urbano)
View(urbano)
View(urbano)
names(urbano) = c("por_ur")
data_rural = cbind(distritos,urbano)
head(data_rural)
View(urbano)
data_rural$por_ur = as.numeric(as.character(data_rural$por_ur))
View(data_rural)
head(data_rural)
write.csv(data_rural, "data_ruralMG.csv")
